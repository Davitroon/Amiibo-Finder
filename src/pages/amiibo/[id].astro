---
interface Amiibo {
  amiiboSeries: string;
  character: string;
  gameSeries: string;
  head: string;
  image: string;
  name: string;
  release: { au?: string; eu?: string; jp?: string; na?: string };
  tail: string;
  type: string;
}

export async function getStaticPaths() {
  const res = await fetch("https://amiiboapi.com/api/amiibo/?page=1");
  const data = await res.json();
  const amiibos: Amiibo[] = data.amiibo;

  return amiibos.map((a) => ({
    params: { id: `${a.head}${a.tail}` }, // sin guión si usas el id así
  }));
}

const { id } = Astro.params; // id = head + tail
const res = await fetch(`https://amiiboapi.com/api/amiibo/?id=${id}`);
const data = await res.json();
const amiibo: Amiibo | undefined = data.amiibo?.[0]; // la API devuelve un array bajo “amiibo”
---

{
  amiibo && (
    <>
      <h1>{amiibo.name}</h1>
      <img src={amiibo.image} alt={amiibo.name} />
      <p>Serie: {amiibo.gameSeries}</p>
      <p>
        ID: {amiibo.head}-{amiibo.tail}
      </p>
      <p>Tipo: {amiibo.type}</p>
      <a href="/">Volver</a>
    </>
  )
}
